
## Extend

Директива `@extend` – одна из возможностей, которая сделала Sass таким известным несколько лет назад. Напомню: она позволяет Sass оформить элемент A именно так, как будто бы он также соответствует селектору B. Разумеется, эта возможность является ценным союзником при написании модульного CSS.

Однако настоящее предназначение `@ extend` заключается в поддержании отношений (соединений) в расширенных селекторах между наборами правил. Что именно это значит?

- Селекторы имеют *соединения* (например, `.bar` в `.foo > .bar` должны иметь родителя `.foo`);
- Эти соединения *соотносятся* на расширенный селектор (например, ``.baz { @extend .bar; }` будет создавать `.foo > .bar, .foo > .baz`);
- Объявления расширенного селектора будут использоваться совместно с расширяемым селектором.

Учитывая это, нетрудно увидеть, как расширение селекторов с мягкими соединениями могут привести к взрыву селектора. Если `.baz .qux` расширяет `.foo .bar`, то результирующий селектор может быть `.foo .baz .qux` или `.baz .foo .qux`, так как `.foo` и `.baz` являются общими предками. Они могут быть родителями, дедушками и далее.

Всегда пытайтесь определить отношения через плейсхолдеры селектора, а не реальные селекторы. Это даст вам свободу использования (и изменения) любого соглашения по именованию для ваших селекторов, и поскольку отношения определяются только один раз внутри плейсхолдеров, у вас гораздо меньше шансов создать непреднамеренные селекторы.

Для наследования стилей используйте только `@extend`, если расширяется селектор `.class` или `%placeholder` - это _своего рода_ расширенный селектор. Например, `.error` своего рода `.warning`, так что `.error` может расширять `.warning`.

{% include snippets/extend/01/index.html %}

Есть ситуации, в которых расширяющие селекторы могут быть полезны, и стоят того, чтобы их использовать. Тем не менее, всегда имейте в виду эти правила, чтобы не попасть в беду:

* Используйте указание `@extend` исключительно на `%placeholder`'ы, а не на обычные селекторы.
* Когда расширяете классы, делайте это только с другим классом и _никогда_ с [составным селектором](https://www.w3.org/TR/selectors4/#syntax).
* Убедитесь, что `%placeholder`, который вы расширяете, присутствует как можно реже в таблице стилей.
* Избегайте расширять общие селекторы предков (т.е. `.foo .bar`) или общие селекторы-сиблинги (одного уровня) (т.е. `.foo ~ .bar`). This is what causes selector explosion. Это и вызывает селекторный взрыв.

<div class="note">
  <p>Говорят, что <code>@extend</code> уменьшает размер файла, так как комбинирует селекторы, а не дублирует код. Это правда, однако разница нивелируется, если используется сжатие <a href="https://en.wikipedia.org/wiki/Gzip">Gzip</a></p>
  <p>Таким образом, если вы не можете использовать Gzip (или любой аналог) то применение <code>@extend</code> может и имеет смысл, особенно если вес таблицы стилей является узким местом производительности проекта.</p>
</div>

### Extend и медиа-запросы

Расширять селекторы стоит только в пределах одной медиа-видимости (директива `@media`). Думайте о медиа-запросе как о другой области.

{% include snippets/extend/02/index.html %}

По поводу `@extend` мнения чрезвычайно полярны, до такой степени, что многие разработчики, включая меня, выступают против него, о чём вы можете прочитать в следующих статьях:

* [What Nobody Told you About Sass Extend](https://www.sitepoint.com/sass-extend-nobody-told-you/)
* [Why You Should Avoid Extend](https://www.sitepoint.com/avoid-sass-extend/)
* [Don't Over Extend Yourself](https://pressupinc.com/blog/2014/11/dont-overextend-yourself-in-sass/)

Подводя итог вышесказанному, я советую использовать `@extend` только для обслуживания взаимосвязи между селекторами. Если два селектора имеют схожие характеристики, то это идеальный случай для применения `@extend`. Если они независят друг от друга, но у них совпадают несколько свойств, то `@mixin` может подойти здесь лучше. Лучше понять как выбрать что-то из этих двух вариантов в [этой статье](https://csswizardry.com/2014/11/when-to-use-extend-when-to-use-a-mixin/).

<div class="note">
  <p>Благодарю <a href="https://twitter.com/davidkpiano">David Khourshid</a> за его помощь и экспертизу этой главы.</p>
</div>
